üõ°Ô∏è Flask Blog: –°–∏—Å—Ç–µ–º–∞ –∑ –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è–º–∏ —Ç–∞ PostgreSQL

–¶–µ–π –ø—Ä–æ—î–∫—Ç —î –≤–µ–±–∑–∞—Å—Ç–æ—Å—É–Ω–∫–æ–º, —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–º –Ω–∞ Python (Flask), —è–∫–∏–π –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î —Ä–æ–±–æ—Ç—É –∑ —Ä–µ–ª—è—Ü—ñ–π–Ω–æ—é –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö PostgreSQL.

–ì–æ–ª–æ–≤–Ω–∞ –º–µ—Ç–∞ –ø—Ä–æ—î–∫—Ç—É ‚Äî —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è ACID-—Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ –¥–∞–Ω–∏—Ö. –î–æ–¥–∞—Ç–æ–∫ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∑–±–µ—Ä—ñ–≥–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, –∞ –≥–∞—Ä–∞–Ω—Ç—É—î, —â–æ –ø–æ–≤'—è–∑–∞–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏–¥–∞–ª–µ–Ω–Ω—è –ø–æ—Å—Ç–∞ —Ç–∞ –π–æ–≥–æ –∞—Ä—Ö—ñ–≤–∞—Ü—ñ—è) –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è —è–∫ —î–¥–∏–Ω–µ —Ü—ñ–ª–µ ("–≤—Å–µ –∞–±–æ –Ω—ñ—á–æ–≥–æ").

üöÄ –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª

1. –°—Ç—Ä—ñ—á–∫–∞ –Ω–æ–≤–∏–Ω

–ü–µ—Ä–µ–≥–ª—è–¥ —É—Å—ñ—Ö –∞–∫—Ç–∏–≤–Ω–∏—Ö –ø–æ—Å—Ç—ñ–≤.

–í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ç–∞ –∑–º—ñ—Å—Ç—É.

2. –°–∏—Å—Ç–µ–º–∞ –†–µ–∞–∫—Ü—ñ–π (–¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π–Ω–∞)

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–∂—É—Ç—å —Å—Ç–∞–≤–∏—Ç–∏ "–õ–∞–π–∫–∏" üëç —Ç–∞ "–î–∏–∑–ª–∞–π–∫–∏" üëé.

–õ–æ–≥—ñ–∫–∞: –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ —Ç–∞ –∑–∞–ø–∏—Å —É –∂—É—Ä–Ω–∞–ª –ø–æ–¥—ñ–π –≤—ñ–¥–±—É–≤–∞—é—Ç—å—Å—è –≤ –æ–¥–Ω—ñ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó.

3. –ë–µ–∑–ø–µ—á–Ω–µ –í–∏–¥–∞–ª–µ–Ω–Ω—è (–ê—Ä—Ö—ñ–≤—É–≤–∞–Ω–Ω—è)

–ü–æ—Å—Ç–∏ –Ω–µ –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è –±–µ–∑—Å–ª—ñ–¥–Ω–æ.

–ü—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ "–í–∏–¥–∞–ª–∏—Ç–∏", –ø–æ—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å—Å—è –≤ —Ç–∞–±–ª–∏—Ü—é archives –∑—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–≥–æ ID —Ç–∞ —á–∞—Å—É –≤–∏–¥–∞–ª–µ–Ω–Ω—è.

4. –ñ—É—Ä–Ω–∞–ª –ê—É–¥–∏—Ç—É (Audit Log)

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ñ—ñ–∫—Å—É—î –≤—Å—ñ –¥—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è, –æ—Ü—ñ–Ω–∫–∞, –≤–∏–¥–∞–ª–µ–Ω–Ω—è).

–ñ—É—Ä–Ω–∞–ª –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –Ω–∞ –±—ñ—á–Ω—ñ–π –ø–∞–Ω–µ–ª—ñ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ.

5. –ü–∞–Ω–µ–ª—å —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞

–ö–Ω–æ–ø–∫–∞ Reset DB: –î–æ–∑–≤–æ–ª—è—î –ø–æ–≤–Ω—ñ—Å—Ç—é –æ—á–∏—Å—Ç–∏—Ç–∏ —Ç–∞ –ø–µ—Ä–µ—ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –±–∞–∑—É –¥–∞–Ω–∏—Ö —Ç–µ—Å—Ç–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏ –≤ –æ–¥–∏–Ω –∫–ª—ñ–∫.

üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏–π —Å—Ç–µ–∫

Backend: Python 3, Flask.

Database: PostgreSQL.

Driver: psycopg2 (–¥–ª—è –∑'—î–¥–Ω–∞–Ω–Ω—è Python –∑ Postgres).

Frontend: HTML5, CSS3 (Grid Layout, –∞–¥–∞–ø—Ç–∏–≤–Ω–∏–π –¥–∏–∑–∞–π–Ω).

Tools: pgAdmin 4 (–¥–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä—É–≤–∞–Ω–Ω—è –ë–î).

üíæ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó (ACID)

–£ –ø—Ä–æ—î–∫—Ç—ñ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —Ç—Ä–∏ –∫–ª—é—á–æ–≤—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π. –Ø–∫—â–æ –±—É–¥—å-—è–∫–∞ —á–∞—Å—Ç–∏–Ω–∞ –æ–ø–µ—Ä–∞—Ü—ñ—ó –≤–∏–∫–ª–∏–∫–∞—î –ø–æ–º–∏–ª–∫—É, –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è ROLLBACK (—Å–∫–∞—Å—É–≤–∞–Ω–Ω—è), —ñ –¥–∞–Ω—ñ –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –Ω–µ–∑–º—ñ–Ω–Ω–∏–º–∏.

üìù –°—Ü–µ–Ω–∞—Ä—ñ–π 1: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ—Å—Ç–∞

INSERT —É —Ç–∞–±–ª–∏—Ü—é posts (—Å–∞–º –ø–æ—Å—Ç).

INSERT —É —Ç–∞–±–ª–∏—Ü—é audit_log (–∑–∞–ø–∏—Å "–°—Ç–≤–æ—Ä–µ–Ω–æ –ø–æ—Å—Ç...").

COMMIT.

üóëÔ∏è –°—Ü–µ–Ω–∞—Ä—ñ–π 2: –ë–µ–∑–ø–µ—á–Ω–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è (Complex Transaction)

–¶–µ –Ω–∞–π—Å–∫–ª–∞–¥–Ω—ñ—à–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è, —â–æ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ —Ç—Ä—å–æ—Ö –∫—Ä–æ–∫—ñ–≤:

Copy: –î–∞–Ω—ñ –∑—á–∏—Ç—É—é—Ç—å—Å—è –∑ posts —ñ –∑–∞–ø–∏—Å—É—é—Ç—å—Å—è –≤ archives.

Delete: –ó–∞–ø–∏—Å –≤–∏–¥–∞–ª—è—î—Ç—å—Å—è –∑ —Ç–∞–±–ª–∏—Ü—ñ posts.

Log: –î–æ–¥–∞—î—Ç—å—Å—è –∑–∞–ø–∏—Å —É audit_log.
–ì–∞—Ä–∞–Ω—Ç—ñ—è: –ü–æ—Å—Ç –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–∏–π, —è–∫—â–æ –≤—ñ–Ω –Ω–µ –±—É–≤ —É—Å–ø—ñ—à–Ω–æ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π –≤ –∞—Ä—Ö—ñ–≤—ñ.

üëç –°—Ü–µ–Ω–∞—Ä—ñ–π 3: –†–µ–∞–∫—Ü—ñ—ó

UPDATE –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ likes –∞–±–æ dislikes —É —Ç–∞–±–ª–∏—Ü—ñ posts.

INSERT –∑–∞–ø–∏—Å—É –ø—Ä–æ —Ä–µ–∞–∫—Ü—ñ—é –≤ audit_log.

‚öôÔ∏è –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –ó–∞–ø—É—Å–∫

–ü–µ—Ä–µ–¥—É–º–æ–≤–∏

–í–∞–º –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π Python —Ç–∞ PostgreSQL (—ñ pgAdmin).

1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ—Ç–æ—á–µ–Ω–Ω—è

# –°—Ç–≤–æ—Ä—ñ—Ç—å –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ
python -m venv venv

# –ê–∫—Ç–∏–≤—É–π—Ç–µ –π–æ–≥–æ (Windows)
venv\Scripts\activate

# –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
pip install flask psycopg2-binary


2. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ë–∞–∑–∏ –î–∞–Ω–∏—Ö

–í—ñ–¥–∫—Ä–∏–π—Ç–µ pgAdmin.

–°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤—É –±–∞–∑—É –¥–∞–Ω–∏—Ö –∑ –Ω–∞–∑–≤–æ—é flask_blog.

–í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–∞–π–ª main.py —ñ –∑–Ω–∞–π–¥—ñ—Ç—å —Å–µ–∫—Ü—ñ—é –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å:

DB_HOST = "localhost"
DB_NAME = "flask_blog"
DB_USER = "postgres"
DB_PASS = "–í–ê–®_–ü–ê–†–û–õ–¨_–í–Ü–î_PGADMIN"  <-- –í–ø–∏—à—ñ—Ç—å —Å–≤—ñ–π –ø–∞—Ä–æ–ª—å


3. –ó–∞–ø—É—Å–∫

python main.py


–ü—ñ—Å–ª—è –∑–∞–ø—É—Å–∫—É –ø–µ—Ä–µ–π–¥—ñ—Ç—å —É –±—Ä–∞—É–∑–µ—Ä—ñ –∑–∞ –∞–¥—Ä–µ—Å–æ—é: http://127.0.0.1:5000/

–í–∞–∂–ª–∏–≤–æ: –ü—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É "‚ö† –°–∫–∏–Ω—É—Ç–∏ –±–∞–∑—É –¥–∞–Ω–∏—Ö (Reset)" —É –ø—Ä–∞–≤–æ–º—É –Ω–∏–∂–Ω—å–æ–º—É –∫—É—Ç—ñ —Å–∞–π—Ç—É, —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–∞–±–ª–∏—Ü—ñ.

üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

main.py ‚Äî –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª –¥–æ–¥–∞—Ç–∫—É. –ú—ñ—Å—Ç–∏—Ç—å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ PostgreSQL, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—é (routes) —Ç–∞ –ª–æ–≥—ñ–∫—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π.

schema.sql ‚Äî SQL-—Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ —Ç–∞–±–ª–∏—Ü—å (posts, audit_log, archives).

templates/ ‚Äî –ü–∞–ø–∫–∞ –∑ HTML-—à–∞–±–ª–æ–Ω–∞–º–∏:

index.html ‚Äî –ì–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ (—Å—Ç—Ä—ñ—á–∫–∞, —Å–∞–π–¥–±–∞—Ä, —Ñ–æ—Ä–º–∏).

archive.html ‚Äî –°—Ç–æ—Ä—ñ–Ω–∫–∞ –ø–µ—Ä–µ–≥–ª—è–¥—É –≤–∏–¥–∞–ª–µ–Ω–∏—Ö –ø–æ—Å—Ç—ñ–≤.

–ê–≤—Ç–æ—Ä: –®–∞–ø–æ–≤–∞–ª –ê—Ä—Ç–µ–º (–Ü–°–î-31)

–í–∏–∫–æ–Ω–∞–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö –Ω–∞–≤—á–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—î–∫—Ç—É –∑ –≤–∏–≤—á–µ–Ω–Ω—è –±–∞–∑ –¥–∞–Ω–∏—Ö —Ç–∞ –≤–µ–±-—Ä–æ–∑—Ä–æ–±–∫–∏.